{% extends 'base.html' %}
{% load static %}
{% load filters %}

{% block style %}
    <link rel="stylesheet" href="{% static 'css/buyback.css' %}">
    <title>Buyback Program - Deep Core Industry</title>
{% endblock %}

{% block title %}
    Buyback Program
{% endblock %}

{% block navbar_menu %}
{% if request.user|has_group:"Admin" %}
<ul class="nav navbar-nav sub-nav">
    <li class="nav-item sub-item">
        <a href="/sso/manager/login/" class="btn btn-primary">Setup Manager</a>
    </li>
    <li class="nav-item sub-item">
        <a href="/buybackprogram/locations/" class="btn btn-primary">Locations</a>
    </li>
</ul>
{% endif %}
{% endblock %}

{% block content %}
    <div class="my-3">
        <div class="card">
            <div class="card-header">
                Buyback Program
                {% if request.user|has_group:"Admin" %}
                <div class="float-end">
                    <a href="/buybackprogram/add/" class="btn btn-sm btn-primary">
                        <i class="bi bi-plus-circle"></i>
                    </a>
                </div>
                {% endif %}
            </div>
            <table style="width: 100%; margin: auto;" class="table table-striped table-hover no-footer w-100">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Location</th>
                        <th>Tax</th>
                        <th>Manager</th>
                        <th>Settings</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody> 
                    {% for program in programs %}
                        <tr>
                            <td>{{program.name}}</td>
                            <td>{{program.location.station_name}}</td>
                            <td>{{program.tax}} %</td>
                            <td>{{program.manager.corp_name}}</td>
                            
                            <td>
                                {% if program.all_items %}
                                <i class="bi bi-globe-europe-africa fa-solid fa-fw" title="This program accepts all types of items."></i>
                                {% endif %}
                                {% if program.freighter %}
                                <i class="bi bi-truck fa-solid fa-fw" title="Items sold via this program have an added freight cost of {{program.freighter_tax}} ISK per mÂ³"></i>
                                {% endif %}
                                {% if program.unpacked_items %}
                                <i class="bi bi-box-seam-fill fa-solid fa-fw" title="Unpacked items are accepted in this program."></i>
                                {% endif %}
                                {% if program.special_taxes != 0 %}
                                <i class="bi bi-search fa-solid fa-fw" title="This program has individual items with adjusted taxes or items that are not allowed in the program."></i>
                                {% endif %}
                                {% if program.jita_buy %}
                                <i class="bi bi-arrow-down fa-solid fa-fw" title="Prices are based on Jita Buy prices"></i>
                                {% endif %}
                                {% if program.jita_sell %}
                                <i class="bi bi-arrow-up fa-solid fa-fw" title="Prices are based on Jita Sell prices"></i>
                                {% endif %}
                            </td>
                            
                            <td class="text-center">
                                <a href="/buybackprogram/{{program.id}}/calculate/" class="btn btn-success btn-sm">Use</a>
                                <a href="/buybackprogram/{{program.id}}/special_taxes/" class="btn btn-warning btn-sm">Special Taxes</a>
                                {% if request.user|has_group:"Admin" %}
                                <a href="/buybackprogram/{{program.id}}/edit/" class="btn btn-primary btn-sm">
                                    <i class="bi bi-pencil-fill"></i>
                                </a>
                                <a href="/buybackprogram/{{program.id}}/del/" class="btn btn-sm btn-danger">
                                    <i class="bi bi-trash-fill"></i>
                                </a>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}